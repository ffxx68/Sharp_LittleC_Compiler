// PC-1403
// blocking : wait for a key stroke - key code table below
char key_wait () {
#asm	
PC1403_ROM_KEYWAIT:
    CALL  0x1494        ; wait for a keystroke
	LIA	LB(0xFF5E)	    ; LB of key-code address
	LIB	HB(0xFF5E)	    ; HB of key-code address
	LP 4
	EXAM		        ; LB -> Xl
	EXAB
	INCP		
	EXAM                ; HB -> Xh
	DX
	IXL                 ; set return value in A
#endasm
	return;
}

// PC-1403
// non-blocking : scan keyboard - key code table below
char key_scan() {
#asm
PC1403_ROM_KEYSCAN:
	CALL 0x0E68 ; key scan; keycode value returned in A
#endasm
	return;
}

// LIST OF KEYCODES	
//       SHARP  POCKET COMPUTER PC-1403H  32KB                 +---+ +---+ +---+ +---+ +---+ +---+ 
//                                                             |hyp| |sin| |cos| |tan| |FSE| |CCE| 
//  on                                                         +---+ +---+ +---+ +---+ +---+ +---+ 
// +-+ +----------------------------------------------------+    67    66    65    64    4     6   
// ¦ ¦ ¦                                    DEG             |  +---+ +---+ +---+ +---+ +---+ +---+ 
// +-+ ¦ >                                                  |  |HEX| |DEG| | ln| |log| |1/x| | ^ | 
// off ¦      _                                             |  +---+ +---+ +---+ +---+ +---+ +---+ 
//     +----------------------------------------------------+    75    74    73    72    11    5   
//       CAL RUN PRO                                           +---+ +---+ +---+ +---+ +---+ +---+ 
//                                                             |EXP| |y^x| | v~| |x^2| | ( | | ) | 
//                                                             +---+ +---+ +---+ +---+ +---+ +---+ 
//                                                               83    82    81    80    17    12  
// +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+  +---+  +---+  +---+  +---+  +---+  
// |CAL| |BAS| |BRK| |DEF| | v | | ^ | | < | | > | |SML| |SHI|  | 7 |  | 8 |  | 9 |  | / |  |X>M|  
// +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+  +---+  +---+  +---+  +---+  +---+  
//   25    22    -     37    3     10    16    21    36    38     35     34     33     32     31   
// +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+  +---+  +---+  +---+  +---+  +---+  
// | Q | | W | | E | | R | | T | | Y | | U | | I | | O | | P |  | 4 |  | 5 |  | 6 |  | * |  | RM|  
// +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+  +---+  +---+  +---+  +---+  +---+  
//   46    54    62    70    78     2     9    15    20    24     43     42     41     40     39   
// +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+  +---+  +---+  +---+  +---+  +---+  
// | A | | S | | D | | F | | G | | H | | J | | K | | L | | , |  | 1 |  | 2 |  | 3 |  | - |  | M+|  
// +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+  +---+  +---+  +---+  +---+  +---+  
//   45    53    61    69    77     1     8    14    19    23     51     50     49     48     47   
// +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---------+  +---+  +---+  +---+  +---+  +---+  
// | Z | | X | | C | | V | | B | | N | | M | |SPC| |  ENTER  |  | 0 |  |+/-|  | . |  | + |  | = |  
// +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---+ +---------+  +---+  +---+  +---+  +---+  +---+  
//   44    52    60    68    76     0     7    13       18        59     58     57     56     55   

// if BRK-key pressed (non blocking), return 1, else 0
byte keybrk ( ) {
	
#asm
LIB_KEYCL1S:    
	TEST 8				; Check for break-key
	JRNZP LIB_KEYCL1E	; If pressed...
	LIA 0
	RTN
LIB_KEYCL1E:
	LIA 1
	RTN
#endasm

}